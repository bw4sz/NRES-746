<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="NRES 746" />


<title>Lab Exercise 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746, Fall 2016</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Course Schedule</a>
</li>
<li>
  <a href="labschedule.html">Lab Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
  </ul>
</li>
<li>
  <a href="Syllabus.pdf">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab Exercise 2</h1>
<h4 class="author"><em>NRES 746</em></h4>
<h4 class="date"><em>September 9, 2016</em></h4>

</div>


<div id="final-projects" class="section level2">
<h2>Final Projects</h2>
<p>Take some time to start forming groups (2-3 people) for final projects.</p>
<div id="general-expectations" class="section level3">
<h3>General expectations</h3>
<p>I will provide a more formal list of expectations for final projects soon, but in a nutshell (and in no particular order), you are expected to perform and write up the results for a sophisticated data analysis using <em>state-of-the-art analytical methods</em>. The write-up will loosely take the format of a scientific paper to be submitted to a professional journal. However, because of the nature of this course, the most important pieces of the write-up are the methods and results sections. Nonetheless, I expect at least a few paragraphs introducing the topic and why it’s important, and a few paragraphs discussing the implications of the results. The methods and results section can (and in many cases should) be much longer than you typically see in a scientific paper- don’t feel constrained by space for these sections! Not that you need to be wordy, I just want to make sure you have the space to clearly explain the analyses you performed and why you made the choices you did.</p>
</div>
<div id="picking-a-topic" class="section level3">
<h3>Picking a topic</h3>
<p>Your final project should not be part of your thesis. That said, there is no requirement that your final project is not <em>relevant</em> to your graduate thesis project. You will end up spending quite a bit of time on your final projects, so think about what types of analyses you want/need to get to know better- ideally something that may strengthen your thesis project.</p>
</div>
<div id="picking-a-dataset" class="section level3">
<h3>Picking a dataset</h3>
<p>You are not required to use a public dataset, but there are lots of great datasets out there… see <a href="https://kevintshoemaker.github.io/NRES-746/Links.html#Data_links">links page</a></p>
<div id="question-1" class="section level4">
<h4>QUESTION 1</h4>
<p>Develop a 1-page “proposal” that briefly describes your research question, your study system, the data set you will use, and what methods you plan to use to test your research question. Proposals are due to me by <strong>Monday 26 September</strong>. All groups should meet with me briefly to go over project ideas in lab on September 29!</p>
</div>
</div>
</div>
<div id="the-virtual-ecologist" class="section level2">
<h2>The Virtual Ecologist</h2>
<p>This is the “real” lab exercise for this week! For the assignment, please keep your work as short and sweet as possible! <strong>LAB 2 is due by midnight on Friday 9/30.</strong></p>
<div id="simulating-data-in-r" class="section level3">
<h3>Simulating Data in R</h3>
<p>First, review the basic approach to simulating data in the <a href="https://kevintshoemaker.github.io/NRES-746/LECTURE3.html">“Virtual Ecologist” lecture</a>.</p>
<div id="question-2-model-verification-and-goodness-of-fit" class="section level4">
<h4>QUESTION 2 (model verification and goodness of fit)</h4>
<p>Simulate data that meets all the standard assumptions of univariate linear regression (as performed with the “lm” function). Then run the “lm” function on these data and examine how closely the parameter estimates match the “true” parameter value. Other choices (sample size, parameter values etc) are up to you!</p>
<ul>
<li>Does the 95% confidence interval contain the true parameter value 95% of the time (a frequentist question!). Can you show this with simulations?</li>
<li>Plot the estimated regression line with a 95% confidence interval around the regression line. Overlay the “true” regression line.</li>
<li>Plot the estimated regression line with a 95% prediction interval. Overlay the “true” data.</li>
</ul>
<p>Note that you can use the ‘predict’ function to get confidence intervals and prediction intervals:</p>
<pre class="r"><code>predict.lm(yourmodel, interval = c(&quot;confidence&quot;), level = 0.95)   # for confidence interval
predict.lm(yourmodel, interval = c(&quot;prediction&quot;), level = 0.95)   # for prediction interval</code></pre>
<ul>
<li><p>Can you write code to simulate the range of regression lines likely to be produced under the fitted model (i.e, within the 95% confidence interval)? Use this code to plot out a large number of replicate regression lines. Overlay the 95% confidence interval produced using the “predict” function.</p></li>
<li><p>Write code to simulate data under the fitted model (i.e, simulate data using the fitted parameter estimates and confidence intervals)? Use this code to plot out a large number of replicate regression lines. Overlay the 95% confidence interval produced using the “predict” function.</p></li>
</ul>
</div>
<div id="question-3-model-verification-2" class="section level4">
<h4>QUESTION 3 (model verification #2)</h4>
<p>Write an R function to generate data that violates <em>one or more</em> of the basic assumptions regarding the error distribution of standard linear regression. Make sure your dataset is realistic! Justify in writing how biological or sampling processes could have produced the data, including (especially) the assumptions violation(s). NOTE: you must specify a linear relationship between your response and predictor (otherwise some of the questions below wouldn’t make sense!).</p>
<p>Some options:</p>
<ul>
<li>use a non-normal error distribution</li>
<li>introduce temporal autocorrelation</li>
<li>introduce other types of correlation structure among the observations</li>
<li>introduce a high-leverage outlier</li>
<li>use a mixture of two error distributions</li>
<li>others?? (feel free to be creative!)</li>
</ul>
<p>Use classical linear regression to analyze these data.</p>
<p>Answer the following questions (keep verbiage to a minimum, and provide all code- with comments!)</p>
<ol style="list-style-type: decimal">
<li>Is the estimate of the regression parameter <em>biased</em>? [note: statistical bias of an estimator is the difference between the estimator’s expected value and the true value of the parameter being estimated]</li>
<li>Is the estimate of the error variance biased?</li>
<li>How well does the <em>confidence interval</em> for the regression parameter match the true confidence interval for the regression parameter? (this is a test for <em>precision</em>)</li>
<li>Try some common data transformations to correct for any assumptions violations. For example, you might log transform, arcsine transform, logit transform, etc… Do these transformations improve the degree to which the regression analysis estimates match the</li>
<li>Can you develop a R routine to simulate data from the model and develop a 95% <em>prediction interval</em> - that is, the interval beyond which only 5% of your observations are likely to fall. The analytical formula for the prediction interval is: <span class="math inline">\(prediction interval formula\)</span> Do your simulation results match the prediction interval above?</li>
<li>Evaluate <em>goodness-of-fit</em> by visualizing the (fake, untransformed) data against the range of data likely to be produced under the regression model. Were your data</li>
</ol>
</div>
<div id="question-3" class="section level4">
<h4>QUESTION 3</h4>
<p>Power analysis.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
